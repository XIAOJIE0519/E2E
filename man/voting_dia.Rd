% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diagnosis.R
\name{voting_dia}
\alias{voting_dia}
\title{Train a Voting Ensemble Diagnostic Model}
\usage{
voting_dia(
  results_all_models,
  data_path,
  label_col_name,
  type = c("soft", "hard"),
  weight_metric = "AUROC",
  top = 5,
  seed = 789,
  threshold_choices = "f1",
  positive_label_value = 1,
  negative_label_value = 0,
  new_positive_label = "Positive",
  new_negative_label = "Negative"
)
}
\arguments{
\item{results_all_models}{A list of results from \code{run_models_dia()},
containing trained base model objects and their evaluation metrics.}

\item{data_path}{A character string, the file path to the input CSV data.}

\item{label_col_name}{A character string, the name of the column containing
the class labels.}

\item{type}{A character string, "soft" for weighted average of probabilities
or "hard" for majority class voting.}

\item{weight_metric}{A character string, the metric to use for weighting
base models in soft voting (e.g., "AUROC", "F1", "Accuracy"). Ignored for hard voting.}

\item{top}{An integer, the number of top-performing base models (ranked by
\code{weight_metric}) to include in the ensemble.}

\item{seed}{An integer, for reproducibility.}

\item{threshold_choices}{A character string (e.g., "f1", "youden", "default")
or a numeric value (0-1) for determining the evaluation threshold for the ensemble.}

\item{positive_label_value}{A numeric or character value in the raw data
representing the positive class.}

\item{negative_label_value}{A numeric or character value in the raw data
representing the negative class.}

\item{new_positive_label}{A character string, the desired factor level name
for the positive class (e.g., "Positive").}

\item{new_negative_label}{A character string, the desired factor level name
for the negative class (e.g., "Negative").}
}
\value{
A list containing:
\itemize{
\item \code{model_object}: A list describing the ensemble model, including
voting type, weight metric (for soft voting), and selected base models.
\item \code{sample_score}: A data frame with \code{sample} (ID), \code{label} (original numeric),
and final \code{score} (probability or 0/1 prediction) from the voting model.
\item \code{evaluation_metrics}: Performance metrics for the Voting model.
}
}
\description{
Implements a Voting ensemble for diagnostic models, combining
predictions from multiple base models either through soft voting (averaging
probabilities with weights) or hard voting (majority class vote).
}
\examples{
\dontrun{
# 1. Create dummy data (same as for run_models_dia)
set.seed(123)
dummy_data <- data.frame(
  ID = paste0("Patient", 1:100),
  FeatureA = rnorm(100),
  FeatureB = runif(100, 0, 100),
  FeatureC = sample(c("X", "Y", "Z"), 100, replace = TRUE),
  Disease_Status = sample(c(0, 1), 100, replace = TRUE)
)
write.csv(dummy_data, "dummy_diagnosis_data.csv", row.names = FALSE)

# 2. Initialize the modeling system
initialize_modeling_system_dia()

# 3. Run a set of base models first
# base_model_results <- run_models_dia(
#   data_path = "dummy_diagnosis_data.csv",
#   label_col_name = "Disease_Status",
#   model = c("lasso", "ridge", "rf", "gbm", "dt"),
#   positive_label_value = 1,
#   negative_label_value = 0,
#   new_positive_label = "Case",
#   new_negative_label = "Control"
# )

# 4. Run Soft Voting ensemble (weighted by AUROC, top 3 models)
# soft_voting_results <- voting_dia(
#   results_all_models = base_model_results,
#   data_path = "dummy_diagnosis_data.csv",
#   label_col_name = "Disease_Status",
#   type = "soft",
#   weight_metric = "AUROC",
#   top = 3,
#   threshold_choices = "f1",
#   positive_label_value = 1,
#   negative_label_value = 0,
#   new_positive_label = "Case",
#   new_negative_label = "Control"
# )
# print_model_summary_dia("Soft Voting", soft_voting_results)

# 5. Run Hard Voting ensemble (top 3 models)
# hard_voting_results <- voting_dia(
#   results_all_models = base_model_results,
#   data_path = "dummy_diagnosis_data.csv",
#   label_col_name = "Disease_Status",
#   type = "hard",
#   top = 3,
#   threshold_choices = "default", # Use 0.5 threshold for hard voting internally
#   positive_label_value = 1,
#   negative_label_value = 0,
#   new_positive_label = "Case",
#   new_negative_label = "Control"
# )
# print_model_summary_dia("Hard Voting", hard_voting_results)

# 6. Clean up
# unlink("dummy_diagnosis_data.csv")
}
}
\seealso{
\code{\link{initialize_modeling_system_dia}}, \code{\link{register_model_dia}},
\code{\link{run_models_dia}}, \code{\link{load_and_prepare_data_dia}},
\code{\link{evaluate_model_dia}}
}
